[{"line":3,"elements":[{"start_timestamp":"2022-09-25T00:49:36.384Z","line":11,"name":"Token generation","description":"","id":"token-generation","type":"scenario","keyword":"Scenario","steps":[{"name":"url WikiBaseUrl","result":{"duration":631249,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":12,"doc_string":{"content_type":"","value":"01:49:36.563 karate.env system property was: features \n01:49:36.569 karate.env = features \n01:49:36.572 config.baseUrl = null \n","line":12}},{"name":"param action = 'query'","result":{"duration":1063290,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":13},{"name":"param meta = 'tokens'","result":{"duration":288757,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":14},{"name":"param type = 'login'","result":{"duration":306472,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":15},{"name":"param format = 'json'","result":{"duration":387810,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":16},{"name":"headers { content-type : 'application\/json; charset=utf-8' }","result":{"duration":46429943,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":17},{"name":"method get","result":{"duration":569863076,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":18,"doc_string":{"content_type":"","value":"01:49:36.796 request:\n1 > GET https:\/\/test.wikipedia.org\/w\/api.php?meta=tokens&format=json&action=query&type=login\n1 > content-type: application\/json; charset=utf-8\n1 > Host: test.wikipedia.org\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/15.0.1)\n1 > Accept-Encoding: gzip,deflate\n\n\n01:49:37.219 response time in milliseconds: 410\n1 < 200\n1 < date: Sun, 25 Sep 2022 00:49:37 GMT\n1 < server: mw1362.eqiad.wmnet\n1 < x-content-type-options: nosniff\n1 < x-frame-options: DENY\n1 < content-disposition: inline; filename=api-result.json\n1 < cache-control: private, max-age=0, s-maxage=0\n1 < vary: Accept-Encoding\n1 < content-length: 100\n1 < content-type: application\/json; charset=utf-8\n1 < age: 0\n1 < x-cache: cp3054 miss, cp3054 pass\n1 < x-cache-status: pass\n1 < server-timing: cache;desc=\"pass\", host;desc=\"cp3054\"\n1 < strict-transport-security: max-age=106384710; includeSubDomains; preload\n1 < report-to: { \"group\": \"wm_nel\", \"max_age\": 86400, \"endpoints\": [{ \"url\": \"https:\/\/intake-logging.wikimedia.org\/v1\/events?stream=w3c.reportingapi.network_error&schema_uri=\/w3c\/reportingapi\/network_error\/1.0.0\" }] }\n1 < nel: { \"report_to\": \"wm_nel\", \"max_age\": 86400, \"failure_fraction\": 0.05, \"success_fraction\": 0.0}\n1 < accept-ch: Sec-CH-UA-Arch,Sec-CH-UA-Bitness,Sec-CH-UA-Full-Version-List,Sec-CH-UA-Model,Sec-CH-UA-Platform-Version\n1 < permissions-policy: interest-cohort=(),ch-ua-arch=(self \"intake-analytics.wikimedia.org\"),ch-ua-bitness=(self \"intake-analytics.wikimedia.org\"),ch-ua-full-version-list=(self \"intake-analytics.wikimedia.org\"),ch-ua-model=(self \"intake-analytics.wikimedia.org\"),ch-ua-platform-version=(self \"intake-analytics.wikimedia.org\")\n1 < x-client-ip: 137.220.84.111\n1 < accept-ranges: bytes\n1 < Set-Cookie: GeoIP=GB:ENG:London:51.51:-0.12:v4; Domain=wikipedia.org; Secure\n1 < Set-Cookie: WMF-Last-Access=25-Sep-2022; Max-Age=1666828800000; Expires=Sun, 08 Jun 54842 00:49:37 GMT; Domain=test.wikipedia.org; Secure\n1 < Set-Cookie: WMF-Last-Access-Global=25-Sep-2022; Max-Age=1666828800000; Expires=Sun, 08 Jun 54842 00:49:37 GMT; Domain=wikipedia.org; Secure\n1 < Set-Cookie: ss0-testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; Domain=test.wikipedia.org; Secure\n1 < Set-Cookie: testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; Domain=test.wikipedia.org; Secure\n{\"batchcomplete\":\"\",\"query\":{\"tokens\":{\"logintoken\":\"f397717a9d471b90ec597f0398304640632fa5a1+\\\\\"}}}\n\n","line":18}},{"name":"status 200","result":{"duration":30237,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":19},{"name":"match response contains { \"batchcomplete\": \"\" }","result":{"duration":8990577,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":20},{"name":"def  loginTokenKey = response.query.tokens.logintoken","result":{"duration":1614319,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# store the token keys from the response"],"keyword":"*","line":23},{"name":"url WikiBaseUrl","result":{"duration":382801,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["#  Action: Step 2: POST request to log in. [Log in]"],"keyword":"Given","line":26},{"name":"headers {\"host\":\"test.wikipedia.org\",\"content-type\":\"application\/x-www-form-urlencoded\"}","result":{"duration":219059,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":27},{"name":"form field action = 'login'","result":{"duration":110442047,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":28},{"name":"form field lgname = 'Sbadada@botTester'","result":{"duration":973397,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":29},{"name":"form field lgpassword = 'chegbj0rjjsvpge212u5064tel7huj9p'","result":{"duration":458414,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":30},{"name":"form field lgtoken = loginTokenKey","result":{"duration":246548,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":31},{"name":"form field format = 'json'","result":{"duration":484635,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":32},{"name":"method post","result":{"duration":616645401,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":33,"doc_string":{"content_type":"","value":"01:49:37.362 request:\n2 > POST https:\/\/test.wikipedia.org\/w\/api.php\n2 > host: test.wikipedia.org\n2 > content-type: application\/x-www-form-urlencoded\n2 > Cookie: GeoIP=GB:ENG:London:51.51:-0.12:v4; testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; ss0-testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; WMF-Last-Access-Global=25-Sep-2022; WMF-Last-Access=25-Sep-2022\n2 > Content-Length: 150\n2 > Connection: Keep-Alive\n2 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/15.0.1)\n2 > Accept-Encoding: gzip,deflate\naction=login&lgname=Sbadada%40botTester&lgpassword=chegbj0rjjsvpge212u5064tel7huj9p&lgtoken=f397717a9d471b90ec597f0398304640632fa5a1%2B%5C&format=json\n\n01:49:37.966 response time in milliseconds: 604\n2 < 200\n2 < date: Sun, 25 Sep 2022 00:49:37 GMT\n2 < server: mw1359.eqiad.wmnet\n2 < x-content-type-options: nosniff\n2 < x-frame-options: DENY\n2 < content-disposition: inline; filename=api-result.json\n2 < cache-control: private, max-age=0, s-maxage=0\n2 < vary: Accept-Encoding\n2 < content-length: 70\n2 < content-type: application\/json; charset=utf-8\n2 < age: 0\n2 < x-cache: cp3064 miss, cp3054 pass\n2 < x-cache-status: pass\n2 < server-timing: cache;desc=\"pass\", host;desc=\"cp3054\"\n2 < strict-transport-security: max-age=106384710; includeSubDomains; preload\n2 < report-to: { \"group\": \"wm_nel\", \"max_age\": 86400, \"endpoints\": [{ \"url\": \"https:\/\/intake-logging.wikimedia.org\/v1\/events?stream=w3c.reportingapi.network_error&schema_uri=\/w3c\/reportingapi\/network_error\/1.0.0\" }] }\n2 < nel: { \"report_to\": \"wm_nel\", \"max_age\": 86400, \"failure_fraction\": 0.05, \"success_fraction\": 0.0}\n2 < accept-ch: Sec-CH-UA-Arch,Sec-CH-UA-Bitness,Sec-CH-UA-Full-Version-List,Sec-CH-UA-Model,Sec-CH-UA-Platform-Version\n2 < permissions-policy: interest-cohort=(),ch-ua-arch=(self \"intake-analytics.wikimedia.org\"),ch-ua-bitness=(self \"intake-analytics.wikimedia.org\"),ch-ua-full-version-list=(self \"intake-analytics.wikimedia.org\"),ch-ua-model=(self \"intake-analytics.wikimedia.org\"),ch-ua-platform-version=(self \"intake-analytics.wikimedia.org\")\n2 < x-client-ip: 137.220.84.111\n2 < accept-ranges: bytes\n2 < Set-Cookie: UseCDNCache=false; Max-Age=1664066987000; Expires=Wed, 01 Dec 54754 14:32:57 GMT; Domain=test.wikipedia.org; Secure\n2 < Set-Cookie: UseDC=master; Max-Age=1664066987000; Expires=Wed, 01 Dec 54754 14:32:57 GMT; Domain=test.wikipedia.org; Secure\n2 < Set-Cookie: cpPosIndex=1%401664066977%23f96970a8b4e01316627cfb194423fa73; Max-Age=1664066987000; Expires=Wed, 01 Dec 54754 14:32:57 GMT; Domain=test.wikipedia.org; Secure\n2 < Set-Cookie: loginnotify_prevlogins=2022-17llxyw-1wsxup5trmwq2qppkgfu4mgyipkp38u; Max-Age=1679618977000; Expires=Fri, 27 Sep 55247 11:46:17 GMT; Domain=test.wikipedia.org; Secure\n2 < Set-Cookie: testwiki_BPsession=to03ndoq8hukhieghabrlqes9uo9772l; Domain=test.wikipedia.org; Secure\n{\"login\":{\"result\":\"Success\",\"lguserid\":55189,\"lgusername\":\"Sbadada\"}}\n\n","line":33}},{"name":"status 200","result":{"duration":8622,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":34},{"name":"match response contains {\"login\":{\"result\":\"Success\",\"lguserid\":55189,\"lgusername\":\"Sbadada\"}}","result":{"duration":469033,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":35},{"name":"url WikiBaseUrl","result":{"duration":93824,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Action: Step 3: GET a CSRF token"],"keyword":"Given","line":39},{"name":"headers { Content-Type: 'application\/json; charset=utf-8', Accept: 'application\/json'}","result":{"duration":94388,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":40},{"name":"param action = 'query'","result":{"duration":466743,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":41},{"name":"param meta = 'tokens'","result":{"duration":584080,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":42},{"name":"param format = 'json'","result":{"duration":394073,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":43},{"name":"method get","result":{"duration":189068394,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":44,"doc_string":{"content_type":"","value":"01:49:37.971 request:\n3 > GET https:\/\/test.wikipedia.org\/w\/api.php?meta=tokens&format=json&action=query\n3 > Content-Type: application\/json; charset=utf-8\n3 > Accept: application\/json\n3 > Cookie: GeoIP=GB:ENG:London:51.51:-0.12:v4; testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; ss0-testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; testwiki_BPsession=to03ndoq8hukhieghabrlqes9uo9772l; WMF-Last-Access-Global=25-Sep-2022; UseDC=master; cpPosIndex=1%401664066977%23f96970a8b4e01316627cfb194423fa73; loginnotify_prevlogins=2022-17llxyw-1wsxup5trmwq2qppkgfu4mgyipkp38u; WMF-Last-Access=25-Sep-2022; UseCDNCache=false\n3 > Host: test.wikipedia.org\n3 > Connection: Keep-Alive\n3 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/15.0.1)\n3 > Accept-Encoding: gzip,deflate\n\n\n01:49:38.158 response time in milliseconds: 187\n3 < 200\n3 < date: Sun, 25 Sep 2022 00:49:38 GMT\n3 < server: mw1380.eqiad.wmnet\n3 < x-content-type-options: nosniff\n3 < x-frame-options: DENY\n3 < content-disposition: inline; filename=api-result.json\n3 < cache-control: private, must-revalidate, max-age=0\n3 < vary: Accept-Encoding\n3 < content-length: 99\n3 < content-type: application\/json; charset=utf-8\n3 < age: 0\n3 < x-cache: cp3064 miss, cp3054 pass\n3 < x-cache-status: pass\n3 < server-timing: cache;desc=\"pass\", host;desc=\"cp3054\"\n3 < strict-transport-security: max-age=106384710; includeSubDomains; preload\n3 < report-to: { \"group\": \"wm_nel\", \"max_age\": 86400, \"endpoints\": [{ \"url\": \"https:\/\/intake-logging.wikimedia.org\/v1\/events?stream=w3c.reportingapi.network_error&schema_uri=\/w3c\/reportingapi\/network_error\/1.0.0\" }] }\n3 < nel: { \"report_to\": \"wm_nel\", \"max_age\": 86400, \"failure_fraction\": 0.05, \"success_fraction\": 0.0}\n3 < accept-ch: Sec-CH-UA-Arch,Sec-CH-UA-Bitness,Sec-CH-UA-Full-Version-List,Sec-CH-UA-Model,Sec-CH-UA-Platform-Version\n3 < permissions-policy: interest-cohort=(),ch-ua-arch=(self \"intake-analytics.wikimedia.org\"),ch-ua-bitness=(self \"intake-analytics.wikimedia.org\"),ch-ua-full-version-list=(self \"intake-analytics.wikimedia.org\"),ch-ua-model=(self \"intake-analytics.wikimedia.org\"),ch-ua-platform-version=(self \"intake-analytics.wikimedia.org\")\n3 < x-client-ip: 137.220.84.111\n3 < accept-ranges: bytes\n{\"batchcomplete\":\"\",\"query\":{\"tokens\":{\"csrftoken\":\"1e33ff3a48790b98770f91d87370d61e632fa5a2+\\\\\"}}}\n\n","line":44}},{"name":"status 200","result":{"duration":23233,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":45},{"name":"match response contains { \"batchcomplete\": \"\" }","result":{"duration":321129,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":46},{"result":{"duration":2481368,"status":"passed"},"comments":["# store the token keys from the response"],"line":49,"name":"print response","match":{"location":"karate","arguments":[]},"keyword":"*","doc_string":{"content_type":"","value":"01:49:38.160 [print] {\n  \"batchcomplete\": \"\",\n  \"query\": {\n    \"tokens\": {\n      \"csrftoken\": \"1e33ff3a48790b98770f91d87370d61e632fa5a2+\\\\\"\n    }\n  }\n}\n \n","line":49}},{"name":"def  csrftoken = response.query.tokens.csrftoken","result":{"duration":706460,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":50},{"name":"url WikiBaseUrl","result":{"duration":68254,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Action: Step 4: Send a POST request, with the CSRF token, to take action on a page"],"keyword":"Given","line":53},{"name":"headers {\"host\":\"test.wikipedia.org\",\"content-type\":\"application\/x-www-form-urlencoded\"}","result":{"duration":76876,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":54},{"name":"form field action = 'edit'","result":{"duration":344021,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":55},{"name":"form field title = 'Project:Sandbox'","result":{"duration":335078,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":56},{"name":"form field text = 'test edit1112'","result":{"duration":251470,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":57},{"name":"form field token = csrftoken","result":{"duration":106822,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":58},{"name":"form field format = 'json'","result":{"duration":153917,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":59},{"name":"method post","result":{"duration":1868932478,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":60,"doc_string":{"content_type":"","value":"01:49:38.165 request:\n4 > POST https:\/\/test.wikipedia.org\/w\/api.php\n4 > host: test.wikipedia.org\n4 > content-type: application\/x-www-form-urlencoded\n4 > Cookie: GeoIP=GB:ENG:London:51.51:-0.12:v4; testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; ss0-testwikiSession=ntrk3sd8hhcqdakbi0d653dakit4jk7l; testwiki_BPsession=to03ndoq8hukhieghabrlqes9uo9772l; WMF-Last-Access-Global=25-Sep-2022; UseDC=master; cpPosIndex=1%401664066977%23f96970a8b4e01316627cfb194423fa73; loginnotify_prevlogins=2022-17llxyw-1wsxup5trmwq2qppkgfu4mgyipkp38u; WMF-Last-Access=25-Sep-2022; UseCDNCache=false\n4 > Content-Length: 119\n4 > Connection: Keep-Alive\n4 > User-Agent: Apache-HttpClient\/4.5.13 (Java\/15.0.1)\n4 > Accept-Encoding: gzip,deflate\naction=edit&title=Project%3ASandbox&text=test+edit1112&token=1e33ff3a48790b98770f91d87370d61e632fa5a2%2B%5C&format=json\n\n01:49:40.032 response time in milliseconds: 1867\n4 < 200\n4 < date: Sun, 25 Sep 2022 00:49:38 GMT\n4 < server: mw1408.eqiad.wmnet\n4 < x-content-type-options: nosniff\n4 < x-frame-options: DENY\n4 < content-disposition: inline; filename=api-result.json\n4 < cache-control: private, max-age=0, s-maxage=0\n4 < vary: Accept-Encoding\n4 < content-length: 113\n4 < content-type: application\/json; charset=utf-8\n4 < age: 4\n4 < x-cache: cp3062 miss, cp3054 pass\n4 < x-cache-status: pass\n4 < server-timing: cache;desc=\"pass\", host;desc=\"cp3054\"\n4 < strict-transport-security: max-age=106384710; includeSubDomains; preload\n4 < report-to: { \"group\": \"wm_nel\", \"max_age\": 86400, \"endpoints\": [{ \"url\": \"https:\/\/intake-logging.wikimedia.org\/v1\/events?stream=w3c.reportingapi.network_error&schema_uri=\/w3c\/reportingapi\/network_error\/1.0.0\" }] }\n4 < nel: { \"report_to\": \"wm_nel\", \"max_age\": 86400, \"failure_fraction\": 0.05, \"success_fraction\": 0.0}\n4 < accept-ch: Sec-CH-UA-Arch,Sec-CH-UA-Bitness,Sec-CH-UA-Full-Version-List,Sec-CH-UA-Model,Sec-CH-UA-Platform-Version\n4 < permissions-policy: interest-cohort=(),ch-ua-arch=(self \"intake-analytics.wikimedia.org\"),ch-ua-bitness=(self \"intake-analytics.wikimedia.org\"),ch-ua-full-version-list=(self \"intake-analytics.wikimedia.org\"),ch-ua-model=(self \"intake-analytics.wikimedia.org\"),ch-ua-platform-version=(self \"intake-analytics.wikimedia.org\")\n4 < x-client-ip: 137.220.84.111\n4 < accept-ranges: bytes\n4 < Set-Cookie: UseCDNCache=false; Max-Age=1664066990000; Expires=Wed, 01 Dec 54754 15:23:00 GMT; Domain=test.wikipedia.org; Secure\n4 < Set-Cookie: UseDC=master; Max-Age=1664066990000; Expires=Wed, 01 Dec 54754 15:23:00 GMT; Domain=test.wikipedia.org; Secure\n4 < Set-Cookie: cpPosIndex=2%401664066980%23f96970a8b4e01316627cfb194423fa73; Max-Age=1664066990000; Expires=Wed, 01 Dec 54754 15:23:00 GMT; Domain=test.wikipedia.org; Secure\n{\"edit\":{\"result\":\"Success\",\"pageid\":107092,\"title\":\"Wikipedia:Sandbox\",\"contentmodel\":\"wikitext\",\"nochange\":\"\"}}\n\n","line":60}},{"name":"status 200","result":{"duration":7109,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":61},{"name":"match response.edit.result == \"Success\"","result":{"duration":870695,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":62},{"name":"print response","result":{"duration":886130,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":63,"doc_string":{"content_type":"","value":"01:49:40.035 [print] {\n  \"edit\": {\n    \"result\": \"Success\",\n    \"pageid\": 107092,\n    \"title\": \"Wikipedia:Sandbox\",\n    \"contentmodel\": \"wikitext\",\n    \"nochange\": \"\"\n  }\n}\n \n","line":63}}],"tags":[{"name":"@MediaWiki","line":1}]}],"name":"KaluzaTests\/features\/mediaWiki-tokenGeneration-modifyPage.feature","description":"Workflow\/request chaining tests for MediaWiki Token generation with modification of the wiki page","id":"workflow-request-chaining-tests-for-mediawiki-token-generation-with-modification-of-the-wiki-page","keyword":"Feature","uri":"KaluzaTests\/features\/mediaWiki-tokenGeneration-modifyPage.feature","tags":[{"name":"@MediaWiki","line":1}]}]